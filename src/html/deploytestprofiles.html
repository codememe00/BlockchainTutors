<!DOCTYPE html>
<meta charset="utf-8" />
<html>

<head>
    <script src="/src/web3.js"></script>
    <script src="/src/jquery.min.js"></script>
</head>

<body>
    <h1>Check the console</h1>
    <a href="/src/web3.js">Should link to web3.js</a>
    <br>
    <a href="/src/CreateTutor.js">Should link to CreateTutor.js</a>
    <br>
    <button onclick="deploy_test_tutors();">Deploy Test Tutors</button>
</body>

<script>
    var MyContractABI;
    var MyContract;
    var web3 = new Web3();
    web3.setProvider(new web3.providers.HttpProvider("http://localhost:5555"));

    function TestConnected() {
        console.log("Is connected = " + web3.isConnected() + "\n");
    }
    TestConnected()
    var eth = web3.eth;

    $.getJSON("/abi/CreateTutor.json", function (result) {
        //console.log(result);
        //console.log(field);
        MyContractABI = result;
        var tmp_networks = [];
        for (var i in MyContractABI.networks) {
            tmp_networks.push(i);
        }
        console.log("tmp_networks = " + tmp_networks);
        console.log(tmp_networks[tmp_networks.length - 1]);
        var tmp_the_correct_network = tmp_networks[tmp_networks.length - 1];
        var address = MyContractABI.networks[tmp_the_correct_network].address;
        MyContract = web3.eth.contract(MyContractABI.abi).at(address);
        MyContract.tutors(web3.eth.coinbase, function (err, result) {
            //console.log(result);
            //console.log(result[0]);
            TutorInformation = result;
            if (result[0] == "") {
                console.log("registertutor()");
            } else {
                console.log("edittutor()");
            }
        });
    });

    function UpdateTutor(tmpID, tmp_value) {
        switch (tmpID) {
            case "tutor_name":
                MyContract.setName(tmp_value, function () {
                    console.log("Ummm what now?")
                });
                break;
            case "tutor_subjects":
                MyContract.setCapableOfTutoring(tmp_value, function () {
                    console.log("Ummm what now?")
                });
                break;
            case "tutor_website":
                MyContract.setWebsite(tmp_value, function () {
                    console.log("Ummm what now?")
                });
                break;
            case "tutor_IPFS":
                MyContract.setIpfsLink(tmp_value, function () {
                    console.log("Ummm what now?")
                });
                break;
            case "tutor_email":
                MyContract.setEmail(tmp_value, function () {
                    console.log("Ummm what now?")
                });
                break;
            default:
                console.log("Something went wrong");
        }
    }
    var names = ["Luke Cage", "Zoe Smith", "Joe Daniels", "Julie Muzullo"];
    var capableOfTutoring = ["Math Science History Piano", "Math Science History Piano", "Math Science History Piano",
        "Math Science History Piano"
    ];


    function CreateTutor(tutor_info, tutor_info) {
        MyContract.createNewTutor(tutor_info[0], tutor_info[1], tutor_info[2], tutor_info[3], tutor_info[4], function () {
            console.log("Information deployed successfully")
        });
    };

    function deploy_test_tutors() {
        console.log("deploy_test_tutors");
        for (var i in names) {
            console.log(i);
            MyContract.createNewTutor(names[i], capableOfTutoring[i], names[i] + ".com", "Random Hash Jibberish", "me@" + names[i] + ".com", {from:web3.eth.accounts[i], gas:4000000},
                function () {
                    console.log("Information deployed successfully")
                });
        }
    }
</script>

</html>